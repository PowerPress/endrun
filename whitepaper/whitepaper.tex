\documentclass[12pt]{article}
\usepackage[margin=1.0in]{geometry}
\usepackage{setspace}
\usepackage{indentfirst}
\usepackage{array}
%\usepackage{longtable}

\PassOptionsToPackage{hyphens}{url}\usepackage{hyperref}

\title{Endrun---Secure Digital Communications For Our Modern Dystopia\footnote{This paper, and the work it describes, represents the work of the authors in their spare time, and represents neither the product, nor the policy, of either author's employer(s). Conclusions of law in this work are not ``legal advice,'' do not establish an attorney-client relationship, and may be neither sane nor coherent.}}
\author{Brendan O'Connor\footnote{Senior Security Consultant, Leviathan Security Group} and Grant Dobbe\footnote{Director of Security and Cloud Meteorologist, NuCivic Inc.}}
\date{October 17, 2014}

\begin{document}
	
	
	\maketitle
  
  \begin{quote}
    \emph{The Internet is no longer trustworthy, having been compromised by bad actors across the globe. Current proposals to work around a compromised Internet rely upon encrypted transport links, mesh networks, or harassing users for being unable to use GPG safely. Each of these strategies fails in different ways that inevitably lead to information leakage or---in the extreme case---death. Endrun, by contrast, takes NASA's Disruption-Tolerant Networking project from a laboratory experiment to a functional system that supports user-friendly encryption in hostile environments. Endrun embraces the nearly-unlimited throughput of a disk-laden station wagon and creates a reliable, eventually-consistent communications system ideal for activists, refugees, and trolls.}
    \end{quote}
	
	\section{Introduction}
	
  It's easy to speak when everyone loves you. When people in the US or the rest of the western world discuss ``free speech,'' they generally mean some form of the right to communicate with others, and to assemble with others for the purpose of sharing their message. Some may also refer to a right to anonymous speech, but there are those who would attack the right of anonymity; ``if you have nothing to hide, you have nothing to fear.''\footnote{XXX CITE} In an era when ``privacy is dead, get over it''\footnote{XXX Zuckerberg}, it's easy to say that ``if you're trying to use an anonymity service, you're probably doing something illegal.''\footnote{XXX Comcast}
  
  We dissent. The right of public speech was not created to protect those messages everyone loves, but those messages that are reviled (for whatver reason). We believe that the current age of ``registered bloggers''\footnote{XXX Russia} and ``you're only press if you have a \$50,000 camera''\footnote{XXX Ferguson} reflects a misguided and destructive impulse to control thought and expression for the sake of centralization of power. We therefore present a system that we intend to provide a useful counterbalance; an easy-to-use, strongly-encrypted information-sharing network built not upon a reliable Internet source, but upon the distributed, unending movements of people. 
  
  \begin{quote}
    \emph{You may stop this individual, but you can't stop us all... after all, we're all alike.}\footnote{``The Conscience of a Hacker,'' The Mentor, Phrack, Volume One, Issue 7, Phile 3 of 10 (Written January 8, 1986; Published September 25, 1986)}
  \end{quote}
  
  \section{Design Goals for Endrun}
  
  Endrun has five major design goals.
  
  \begin{enumerate}
    \item Endrun is designed to make an ``end run'' around the Internet, for the purpose of giving a communications option to people who cannot use the Internet. This could happen for any of several reasons: the Internet could have suffered a major regional or global failure, due to natural disaster, accident, or hostility; the Internet might be considered untrustworthy, due to adversary action; or the areas being communicated across might be so remote that Internet connectivity is simply not a useful option.\footnote{While a large portion of the planet is served at least by bidirectional satellite Internet service, if nothing else, such service is often overwhelmingly expensive for all but the largest corporations, and this service does not reach the entire planet.}
    
    \item Endrun is designed for communications between small groups of people---``cells'' or ``pods.'' It is not designed for open-ended communication between people that have no prior relationship.
    
    \item Endrun is ``by any means necessary.'' Endrun is designed to work across any form of communication that is available, whether that's physical data movement and low-power transient unlicensed radio links, as we would recommend, or by Earth-Moon-Earth (EME) high-powered signals from fix points, or even amateur (ham) radio.\footnote{Although this last would almost certainly be illegal in many countries for several reasons, among them Endrun's use of multiple layers of strong encryption, and the fact that messages may not necessarily be originated by ham radio stations.}
    
    \item Endrun is disruption- and delay-tolerant. It is designed to work where nodes have no real- or bounded-time connection to each other, for instance, when couriers are moving data stored on physical media either around town or across a continent.
    
    \item Endrun is built using standard, well-tested, open source components, combined using Python, rather than using all custom code. Not only does this mean Endrun benefits from the work of thousands of programmers over many years, with all the attendant work on security that implies, but it also means that Endrun is customizable by programmers in the field; in an emergency situation, this can give flexibility that fully-custom solutions cannot.
    
  \end{enumerate}
  
  \section{Previous Work}
  
  There has been a great deal of interest in the area of distributed communication tools, both ones that work over the public Internet, and ones that establish their own wireless links. We will examine several of the largest and most influential projects.
  
  \subsection{Tor}
  
  Tor\footnote{\url{https://www.torproject.org}} is an incredibly-well-known tool for anonymous Internet access. The core security concept of Tor is called ``onion routing,'' where a client picks several nodes to pass the client's message through, and repeatedly encrypts the message with the public key of each node; the message is then routed in turn through each node. This means that if a client picks nodes A, B, and C to transit the message through, in that order, then node A knows where the message originated but not where it is destined (nor its contents), node C knows the message's destination and contents (assuming that no additional encryption is used), but not where it originated, and node B knows neither the message's contents, nor its source, nor its destination.
  
  Tor was originally developed by the U.S. Naval Research Laboratory, subsequently developed by the Defense Advanced Research Projects Agency, and then transferred for ongoing development to The Tor Project, a U.S.-based nonprofit corporation. It is rightly lauded as one of the most important security projects since the invention of networked computing; that said, it has certain deficits which raise concerns for anonymity applications. One of these is that when an adversary is able to monitor both the source and destination networks of a Tor message, a trivial timing analysis will reveal which user sent which message. This was revealed very dramatically through the near-instantaneous reidentification and arrest of Eldo Kim after he used Tor to send a bomb threat to Harvard University, which he attended at the time, apparently to escape a final exam.\footnote{``Harvard Student Receives F For Tor Failure While Sending `Anonymous' Bomb Threat,'' Runa A.\ Sandvik, Forbes, December 18, 2013, \url{http://www.forbes.com/sites/runasandvik/2013/12/18/harvard-student-receives-f-for-tor-failure-while-sending-anonymous-bomb-threat/}} Another, related, issue is that if an adversary controls a significant percentage of the total Tor network, they will nearly always be able to identify both the source and destination of any message (through a timing analysis of any message that both enters and leaves the Tor network through the adversary's systems). Both of these problems were noted in the original Tor paper.\footnote{``Tor does not claim to completely solve end-to-end timing or intersection attacks.'' Page 4 of ``Tor: The Second-Generation Onion Router,'' Roger Dingledine, Nick Mathewson, Paul Syverson, Proceedings of the 13th USENIX Security Symposium, 2004, \url{https://www.usenix.org/legacy/events/sec04/tech/full_papers/dingledine/dingledine.pdf}} At the time, however, it was believed that increased Tor usage, with an attendant increase in Tor nodes, would render controlling a majority of machines impractical.
  
  Unfortunately, this assumption is now believed to be incorrect. Tor's public metrics\footnote{\url{https://metrics.torproject.org/network.html}} indicate the daily average number of nodes is approximately 6,000 (as of September 2014). An adversary could match that number of nodes (and thus control 50\% of the total nodes on the network) relatively cheaply; using Amazon Web Services On-Demand Micro Instances, 6,000 nodes would cost just \$56,160 per month to operate (plus bandwidth).\footnote{Pricing data from \url{http://aws.amazon.com/ec2/pricing/}.} An adversary with a relatively small datacenter and sufficient bandwidth could spend significantly less on an ongoing basis to compromise the Tor network, and there are allegations that certain entities have already done so. We believe that Tor is now insufficient for truly-suppressed parties to communicate anonymously in the face of a network-level adversary.
  
  \subsection{Anonymous AirChat}
  
  Airchat\footnote{\url{https://github.com/lulzlabs/AirChat/}} was announced on April 23, 2014, to great fanfare, promising Internet-free end-to-end encrypted connection suitable for text and low-bandwidth digital voice communication over up to 100 miles, using simple radios. Airchat has the dubious distinction of stating an intent to use the system over amateur radio, on which encryption is forbidden (except in certain circumstances), and further stating that ``we dont give a fucking shit about prohibitions over the use of encryption. fuck you NSA. [sic]\footnote{\url{https://github.com/lulzlabs/AirChat/commit/1b289a8a46c7c25c419a8d2b9b761db13142e53d\#diff-c47c7c7383225ab55ff591cb59c41e6bR174}}'' Setting aside the question of an openly-stated conspiracy to violate U.S. regulations (among many other countries that prohibit encryption on amateur radio frequencies), AirChat seems reasonable. The downside, however, is that it is an online protocol; both sides are communicating continuously, and due to their use of fairly low-throughput protocols,\footnote{The default protocol for AirChat is PSK500R, providing 506 baud of throughput; since PSK500R uses binary keying, this means it is transmitting just 506 bits per second.} stations are communicating for a long time. The use of ham radios means that stations are also communicating using relatively high power,\footnote{An average ham ``Handie-Talkie,'' or HT, transmits at 5W out of the box; amateurs in many countries may use up to 1500W of transmitting power.} which, when combined with the need to transmit for long periods of time in once place, means that stations can easily be located.
  
  If stations can be located easily, they can be destroyed very easily. It has been reported that Syria may have used missiles that track satellite phones to kill journalists.\footnote{``Caveat utilitor: Satellite phones can always be tracked,'' Frank Smyth, Committee to Protect Journalists, February 24, 2012, \url{http://cpj.org/blog/2012/02/caveat-utilitor-satellite-phones-can-always-be-tra.php}} One representative satellite phone, the Iridium Extreme 9575 Satellite Phone, transmits at approximately 250mW,\footnote{\url{https://apps.fcc.gov/eas/GetApplicationAttachment.html?id=1508135}} or 1/20th the transmit power of a typical cheap ham radio. This means a node running AirChat could face a missile even more easily than a satellite phone. Unfortunately, we believe that high-powered wireless links cannot be the basis of a system designed to protect anonymity in hostile areas, given this capability.
  
  \subsection{Commotion Wireless / Project Byzantium}
  
  \subsection{NASA Disruption-Tolerant Network}
  
  \section{Method}
  
  \subsection{Message Format}
  
  \subsection{Routing}
  
  \subsection{Transport}
  
  \subsection{User Services}
  
  \section{Communication Example}
  
  XXX I got it from Agnes
  
  \section{Future Work}

\end{document}